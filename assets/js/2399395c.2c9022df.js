"use strict";(self.webpackChunknemesisdb=self.webpackChunknemesisdb||[]).push([[5547],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),m=a,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||r;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3538:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(7462),a=(n(7294),n(3905));const r={sidebar_position:1,displayed_sidebar:"homeSidebar"},i="Linux",l={unversionedId:"home/install/docker/linux",id:"home/install/docker/linux",title:"Linux",description:"The Docker image should be ok on Mac but this has not been tested.",source:"@site/docs/home/install/docker/linux.md",sourceDirName:"home/install/docker",slug:"/home/install/docker/linux",permalink:"/home/install/docker/linux",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,displayed_sidebar:"homeSidebar"},sidebar:"homeSidebar",previous:{title:"Docker",permalink:"/category/docker"},next:{title:"Windows",permalink:"/home/install/docker/windows"}},s={},c=[{value:"Pull",id:"pull",level:2},{value:"Start",id:"start",level:2},{value:"Default Config",id:"default-config",level:3},{value:"Custom Config",id:"custom-config",level:3},{value:"Stop",id:"stop",level:2}],p={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"linux"},"Linux"),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The Docker image should be ok on Mac but this has not been tested.")),(0,a.kt)("h2",{id:"pull"},"Pull"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull nemesisdb/nemesisdb:latest\n")),(0,a.kt)("p",null,"Confirm:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker images\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"REPOSITORY            TAG       IMAGE ID       CREATED        SIZE\nnemesisdb/nemesisdb   0.3.2     6c2973cf3e57   5 hours ago    17.9MB\n")),(0,a.kt)("h2",{id:"start"},"Start"),(0,a.kt)("p",null,"On Linux, Docker containers can use the host's network which avoids having to map ports between host and container."),(0,a.kt)("p",null,"If you have Docker Desktop installed, you need to do this first:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker context use default\n")),(0,a.kt)("details",null,(0,a.kt)("summary",null,"What does this do"),(0,a.kt)("div",null,(0,a.kt)("div",null,"We need this because Docker Desktop on Linux runs within a VM, so the container will bind to the VM's virtual network rather than the host. Running this command tells Docker to use the 'default' context rather than the Docker Desktop, so the container can bind directly to the host's network ports.",(0,a.kt)("br",null),(0,a.kt)("br",null),"See ",(0,a.kt)("a",{href:"https://docs.docker.com/desktop/faqs/linuxfaqs/"},"here")," for more."))),(0,a.kt)("h3",{id:"default-config"},"Default Config"),(0,a.kt)("p",null,"The default config, included in the image, starts the server on ",(0,a.kt)("inlineCode",{parentName:"p"},"0.0.0.0:1987")," so it is available from the host at ",(0,a.kt)("inlineCode",{parentName:"p"},"127.0.0.1:1987"),"."),(0,a.kt)("p",null,"Start with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run --rm -d --network host --name test1 nemesisdb/nemesisdb:latest\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"rm")," deletes the container when you stop it. Omit ",(0,a.kt)("inlineCode",{parentName:"li"},"--rm")," to retain the container"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"d")," runs detached to avoid blocking the terminal. Replace with ",(0,a.kt)("inlineCode",{parentName:"li"},"-it")," to attach the container's terminal."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"network host")," tells the container to use the host's network stack, which avoids having to map ports between host and container (i.e. ",(0,a.kt)("inlineCode",{parentName:"li"},"-p 1987:1987"),")")),(0,a.kt)("p",null,"Confirm the server is running and its ports are bound to the host:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"netstat -tl | grep :1987\n")),(0,a.kt)("p",null,"You should have at least one entry:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"tcp        0      0 0.0.0.0:1987            0.0.0.0:*               LISTEN     \ntcp        0      0 0.0.0.0:1987            0.0.0.0:*               LISTEN     \ntcp        0      0 0.0.0.0:1987            0.0.0.0:*               LISTEN \n")),(0,a.kt)("h3",{id:"custom-config"},"Custom Config"),(0,a.kt)("p",null,"If you want to bind the server to a different IP/port you can pass the path to a config file on the host."),(0,a.kt)("p",null,"To do this you need to mount a volume so the container can see the config file using the ",(0,a.kt)("inlineCode",{parentName:"p"},"-v")," option."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run --rm -d -v ./server/configs:/configs --network host --name test1 nemesisdb/nemesisdb:latest --config=/configs/config.json\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"-v")," we want a volume mount"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"./server/configs")," is the host path containing the config file"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},":/configs")," sets the mount ",(0,a.kt)("strong",{parentName:"li"},"within")," the container")),(0,a.kt)("p",null,"The final argument ",(0,a.kt)("inlineCode",{parentName:"p"},"--config=/configs/config.json")," is the full path. We use ",(0,a.kt)("inlineCode",{parentName:"p"},"/configs/")," because that's the mount point in the container (step 3)"),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"You can also set the ",(0,a.kt)("inlineCode",{parentName:"p"},"ro")," option to mount as read-only: ",(0,a.kt)("inlineCode",{parentName:"p"},"-v ./server/configs:/configs:ro"),".")),(0,a.kt)("h2",{id:"stop"},"Stop"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker stop test1\n")),(0,a.kt)("p",null,"If you started interactively (",(0,a.kt)("inlineCode",{parentName:"p"},"-it"),"), use ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl+c")," to stop."),(0,a.kt)("p",null,"This will also delete the container because the container was started with ",(0,a.kt)("inlineCode",{parentName:"p"},"--rm"),"."),(0,a.kt)("br",null))}d.isMDXComponent=!0}}]);